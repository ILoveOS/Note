# MIPS

### **MIPS设计原则**

<font color=red>设计目标</font>
- 最优性能    
- 最小开销    
- 减少设计时间    
- 最小能耗

<font color=red>简单源于规整</font>
- 规整的指令格式可以简化硬件设计，使计算高性能低功耗
- 指令格式少
- 前6位位操作码

<font color=red>越小越快</font>
- 指令数量少
- 寄存器数量较少

<font color=red>加速大概率事件</font>
- 操作数来自寄存器
- 允许立即数作为操作数

<font color=red>优秀的设计需要适宜的折中方案</font>
- 三种指令格式  R型(ALU) I型(LOAD/STORE) J型(跳转)

---

### **MIPS指令字段**

|op|rs|rt|rd|shamt|funct|
|:-:|:-:|:-:|:-:|:-:|:-:|
|6bits|5bits|5bits|5bits|5bits|6bits|

- `op`:指令的基本操作(操作码)
- `rs`:第一个源操作数寄存器
- `rt`:第二个源操作数寄存器
- `rd`:目标寄存器
- `shamt`:位移量
- `funct`:功能码(ALU)

<font color=red>指令类别</font>
- 算术指令
- 逻辑运算指令
- 数据传送指令
- 跳转和分支指令
- 特殊指令

<font color=red>寄存器</font>
- R0-R31    通用寄存器
- PC    程序计数器
- HI    
- LO

---

### **算术逻辑运算指令**

- 算术指令(R型)
- 常数或立即数操作数(I型)   range -2<sup>15</sup>~2<sup>15</sup>-1
- 使用大常数
    算术位移、逻辑位移
- 有符号、无符号二进制数、补码、有符号数取反、符号拓展、
- 逻辑操作
    与或非

---

### **数据传输指令**

- 为了进行算术运算
    - 将数据从存储器读入寄存器
    - 将计算结果从寄存器写回存储器
    - 数据传送指令：访问存储器的指令
- 存储器地址:只有一种寻址方法: 基址寄存器+offset
- `lb`(字节8bits) `sb` `lh`(半字16bits) `sh` `lw`(字32bits) `sw`
- 大端法
  
    低字节放在高地址

    例如0x12345678 起始地址0x0
    |0x12|0x34|0x56|0x78|
    |-|-|-|-|
    |0x00|0x04|0x08|0x0C|
- 小端法
      
    低字节放在低地址

    例如0x12345678 起始地址0x0
    |0x78|0x56|0x34|0x12|
    |-|-|-|-|
    |0x00|0x04|0x08|0x0C|

---

### **决策指令**

- 条件分支语句`bne` `beq`
    - 使用I型指令格式
- 决策指令:`slt` `ble` `bgt` `bge`
- 边界检查的最简单方法 无符号比较x < y 同时可以检测x是否为负数
    ```asm
        sltu $t0,$s0,$s1
        beq $t0,$zero,IndexOutOfBounds
    ```
- 无条件分支指令

---

### **过程调用指令**

- 跳转和链接指令:`jal`
- 寄存器跳转指令:`jr`
- 使用更多寄存器:在栈中保存过程的寄存器状态

---

### **MIPS寻址模式总结**

1. 立即数寻址(I型)
    |op|rs|rt|立即数|
    |-|-|-|-|
2. 基址寻址(基址+offset)
    |op|rs|rt|rd|shamt|funct|
    |-|-|-|-|-|-|
    
    地址为(rs+offset)

    当offset=0时为直接寄存器寻址
